{
    "Domains": [
        "dev.sfproductlabs.com"
    ],
    "DatabaseVersion": 1,
    "ApiVersion": 1,
    "StaticDirectory": "public",
    "ProxyUrl": "http://localhost:3030",
    "UseLocalTLS": true,
    "ProxyPortTLS" : ":8443",
    "ProxyPort" : ":8080",
    "Notify": [
        {
            "Service": "cassandra",
            "Hosts": [
                "127.0.0.1"
            ],
            "Context": "sfpla",
            "CACert": "cstarcacert.pem",
            "Cert": "cstarcert.pem",
            "Key": "cstarkey.pem",
            "Secure": false,
            "Retry": false,
            "Critical" :true
        },
        {
            "Service": "nats",
            "Hosts": [
                "tls://localhost:4222"
            ],
            "Context": "tic.track.*",
            "Secure": true,
            "CACert": "natscacert.pem",
            "Cert": "natscert.pem",
            "Key": "natskey.pem",
            "Format": "json"
        }
    ],
    "Consume": [
        {
            "Service": "http",
            "Note": "Not implemented"
        },
        {
            "Service": "nats",
            "Hosts": [
                "tls://localhost:4222"
            ],
            "Secure": true,
            "Critical" : true,
            "CACert": "natscacert.pem",
            "Cert": "natscert.pem",
            "Key": "natskey.pem",
            "Format": "json",
            "MessageLimit": 65536,
            "BytesLimit": 67108864,
            "Filter": [
                {
                    "Alias": "log",
                    "Type": "chan",
                    "Id": "tic.log.>",
                    "Queries": [
                        {
                            "Service": "cassandra",
                            "Statement": "INSERT INTO logs JSON ?",
                            "QueryType": "json",
                            "Fields": [
                                {
                                    "Type": "string",
                                    "Id": "name"
                                },
                                {
                                    "Type": "string",
                                    "Id": "hostname"
                                },
                                {
                                    "Type": "int",
                                    "Id": "level"
                                },
                                {
                                    "Type": "string",
                                    "Id": "msg"
                                },
                                {
                                    "Type": "string",
                                    "Id": "ip"
                                },
                                {
                                    "Type": "string",
                                    "Id": "username"
                                },
                                {
                                    "Type": "date",
                                    "Id": "ldate"
                                },
                                {
                                    "Type": "time",
                                    "Id": "ltime"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Alias": "count",
                    "Type": "chan",
                    "Id": "tic.count.>",
                    "Queries": [
                        {
                            "Service": "cassandra",
                            "Statement": "UPDATE counters set total=total+1 where id=? AND type=?",
                            "Fields": [
                                {
                                    "Type": "string",
                                    "Id": "id"
                                },
                                {
                                    "Type": "string",
                                    "Id": "type"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Alias": "update",
                    "Type": "chan",
                    "Id": "tic.update.>",
                    "Queries": [
                        {
                            "Service": "cassandra",
                            "Statement" : "INSERT INTO updates (id, updated, msg) values (?,?,?)",
                            "Fields": [
                                {
                                    "Type": "string",
                                    "Id": "id",
                                    "Default": "id"                                    
                                },
                                {
                                    "Type": "datetime",
                                    "Id": "updated"
                                },
                                {
                                    "Type": "string",
                                    "Id": "msg"
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}